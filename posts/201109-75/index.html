<!DOCTYPE html><html lang="kr-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="학원 #75일차: Chain of Responsibility 패턴, Persistance 프레임워크 MyBatis" /><meta name="author" content="hayeon_kim" /><meta property="og:locale" content="kr_KR" /><meta name="description" content="CommandFilterManager 변경" /><meta property="og:description" content="CommandFilterManager 변경" /><link rel="canonical" href="https://hayeon17kim.github.io//posts/201109-75/" /><meta property="og:url" content="https://hayeon17kim.github.io//posts/201109-75/" /><meta property="og:site_name" content="하연" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-11-09T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="학원 #75일차: Chain of Responsibility 패턴, Persistance 프레임워크 MyBatis" /><meta name="twitter:site" content="@MONI56219559" /><meta name="twitter:creator" content="@hayeon_kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"hayeon_kim"},"headline":"학원 #75일차: Chain of Responsibility 패턴, Persistance 프레임워크 MyBatis","dateModified":"2020-11-09T00:00:00+08:00","datePublished":"2020-11-09T00:00:00+08:00","description":"CommandFilterManager 변경","url":"https://hayeon17kim.github.io//posts/201109-75/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hayeon17kim.github.io//posts/201109-75/"},"@context":"https://schema.org"}</script><title>학원 #75일차: Chain of Responsibility 패턴, Persistance 프레임워크 MyBatis | 하연</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-173202420-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-173202420-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/bio-photo.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">하연</a></div><div class="site-subtitle font-italic">어제보다 나은 코드를 위해</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-laptop-code ml-xl-3 mr-xl-3 unloaded"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/hayeon17kim" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/MONI56219559" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hayeon17kim','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>학원 #75일차: Chain of Responsibility 패턴, Persistance 프레임워크 MyBatis</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>학원 #75일차: Chain of Responsibility 패턴, Persistance 프레임워크 MyBatis</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Nov 9, 2020, 12:00 AM +0800" > Nov 9, 2020 <i class="unloaded">2020-11-09T00:00:00+08:00</i> </span> by <span class="author"> hayeon_kim </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4746 words">26 min</span></div></div><div class="post-content"><h2 id="commandfiltermanager-변경">CommandFilterManager 변경</h2><p>이전 수업에서는 Chain of Responsibility 패턴을 적용해 CommandFilter, CommandFilterManager, FilterChain을 만들었다. 이번 수업에는 <code class="language-plaintext highlighter-rouge">CommandFilter</code> 구현체를 관리하고 실행하는 역할을 하는 <code class="language-plaintext highlighter-rouge">CommandFilterManager</code> 를 LinkedList 구조로 바꾸었다.</p><p><strong>Chain of Responsibility 패턴</strong></p><ul><li><strong>작업 요청을 받은 객체(sender)</strong>가 <strong>작업자(receiver)</strong>에게 그 <strong>책임을 위임하는 구조</strong>에서 사용하는 설계 기법이다.<li><strong>작업자 간에 연결 고리를 구축</strong>하여 작업을 <strong>나누어 처리</strong>할 수 있다.<li>체인 방식이기 때문에 <strong>작업에 참여하는 모든 객체가 서로 알 필요가 없다.</strong><li>오직 자신과 연결된 <strong>다음 작업자만 알면</strong> 되기 때문에 <strong>객체 간에 결합도를 낮추는 효과</strong>가 있다.<li>보통 <strong>필터링을 구현</strong>할 때 이 설계 기법을 많이 사용한다.</ul><p><strong>CommandFilterManager</strong></p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.eomcs.pms.filter</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.eomcs.pms.handler.Request</span><span class="o">;</span>

<span class="c1">// 역할:</span>
<span class="c1">// - CommandFilter 구현체를 관리하고 실행시킨다.</span>
<span class="c1">// -</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CommandFilterManager</span> <span class="o">{</span>
  <span class="nc">Chain</span> <span class="n">firstChain</span><span class="o">;</span>
  <span class="nc">Chain</span> <span class="n">lastChain</span><span class="o">;</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">CommandFilter</span> <span class="n">filter</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Chain</span> <span class="n">chain</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Chain</span><span class="o">(</span><span class="n">filter</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">lastChain</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">firstChain</span> <span class="o">=</span> <span class="n">lastChain</span> <span class="o">=</span> <span class="n">chain</span><span class="o">;</span>
      <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="n">lastChain</span><span class="o">.</span><span class="na">nextChain</span> <span class="o">=</span> <span class="n">chain</span><span class="o">;</span>
    <span class="n">lastChain</span> <span class="o">=</span> <span class="n">chain</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="nc">FilterChain</span> <span class="nf">getFilterChains</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">firstChain</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="c1">// 각각의 필터에게 준비하라고 요청한다.</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">Chain</span> <span class="n">chain</span> <span class="o">=</span> <span class="n">firstChain</span><span class="o">;</span> <span class="c1">// 첫번째 체인을 가져온다.</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">chain</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// 그 체인이 있다면 </span>
      <span class="n">chain</span><span class="o">.</span><span class="na">filter</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">context</span><span class="o">);</span> <span class="c1">// 그 체인의 필터에 대해 초기화시킨다.</span>
      <span class="n">chain</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="na">nextChain</span><span class="o">;</span> <span class="c1">// 그 체인의 다음 체인을 가져온다.</span>
    <span class="o">}</span> <span class="c1">// 더이상 체인이 없다면 나간다.</span>
  <span class="o">}</span>

  <span class="c1">//각각의 필터에게 마무리하라고 요청한다.</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">()</span> <span class="o">{</span>
    <span class="nc">Chain</span> <span class="n">chain</span> <span class="o">=</span> <span class="n">firstChain</span><span class="o">;</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">chain</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">chain</span><span class="o">.</span><span class="na">filter</span><span class="o">.</span><span class="na">destroy</span><span class="o">();</span>
      <span class="n">chain</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="na">nextChain</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Chain</span> <span class="kd">implements</span> <span class="nc">FilterChain</span> <span class="o">{</span>
    <span class="nc">CommandFilter</span> <span class="n">filter</span><span class="o">;</span>
    <span class="nc">Chain</span> <span class="n">nextChain</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Chain</span><span class="o">(</span><span class="nc">CommandFilter</span> <span class="n">filter</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">this</span><span class="o">.</span><span class="na">filter</span> <span class="o">=</span> <span class="n">filter</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 커맨드 필터에게 위임 (다음 필터체인을 넘겨줌)</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doFilter</span><span class="o">(</span><span class="nc">Request</span> <span class="n">request</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
      <span class="n">filter</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">nextChain</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><strong>CommandFilter</strong></p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CommandFilter</span> <span class="o">{</span>
  <span class="k">default</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span><span class="nc">Object</span><span class="o">&gt;</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
  <span class="o">}</span>
  
  <span class="kt">void</span> <span class="nf">doFilter</span><span class="o">(</span><span class="nc">Request</span> <span class="n">request</span><span class="o">,</span> <span class="nc">FilterChain</span> <span class="n">next</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>
  
  <span class="k">default</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">(){}</span>
<span class="o">}</span>
</pre></table></code></div></div><p><strong>App.service()</strong></p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre>    
<span class="c1">//........</span>
	  <span class="c1">// commandMap 객체를 context 맵에 보관한다.</span>
    <span class="c1">// =&gt; 필터나 커맨드 객체가 사용할 수 있기 때문이다.</span>
    <span class="n">context</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"commandMap"</span><span class="o">,</span> <span class="n">commandMap</span><span class="o">);</span>

    <span class="c1">// 필터 관리자 준비</span>
    <span class="nc">CommandFilterManager</span> <span class="n">filterManager</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CommandFilterManager</span><span class="o">();</span>

    <span class="c1">// 필터를 등록한다.</span>
    <span class="n">filterManager</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">LogCommandFilter</span><span class="o">());</span>
    <span class="n">filterManager</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">AuthCommandFilter</span><span class="o">());</span>
    <span class="nc">FilterManager</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">DefaultCommandFilter</span><span class="o">());</span>

    <span class="c1">// 필터가 사용할 값을 context 맵에 담는다.</span>
    <span class="nc">File</span> <span class="n">logFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="s">"command.log"</span><span class="o">);</span>
    <span class="n">context</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"logFile"</span><span class="o">,</span> <span class="n">logfile</span><span class="o">);</span>

    <span class="c1">// 필터들을 준비시킨다.</span>
    <span class="n">filterManager</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>

    <span class="c1">// 사용자가 입력한 명령을 처리할 필터 체인을 얻는다.</span>
    <span class="nc">FilterChain</span> <span class="n">filterChain</span> <span class="o">=</span> <span class="n">filterManager</span><span class="o">.</span><span class="na">getFilterChains</span><span class="o">();</span>

    <span class="nl">loop:</span>
      <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">inputStr</span> <span class="o">=</span> <span class="nc">Prompt</span><span class="o">.</span><span class="na">inputString</span><span class="o">(</span><span class="s">"명령&gt; "</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">inputStr</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">continue</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="n">commandStack</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">inputStr</span><span class="o">);</span>
        <span class="n">commandQueue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">inputStr</span><span class="o">);</span>

        <span class="k">switch</span> <span class="o">(</span><span class="n">inputStr</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">case</span> <span class="s">"history"</span><span class="o">:</span> <span class="n">printCommandHistory</span><span class="o">(</span><span class="n">commandStack</span><span class="o">.</span><span class="na">iterator</span><span class="o">());</span> <span class="k">break</span><span class="o">;</span>
          <span class="k">case</span> <span class="s">"history2"</span><span class="o">:</span> <span class="n">printCommandHistory</span><span class="o">(</span><span class="n">commandQueue</span><span class="o">.</span><span class="na">iterator</span><span class="o">());</span> <span class="k">break</span><span class="o">;</span>
          <span class="k">case</span> <span class="s">"quit"</span><span class="o">:</span>
          <span class="k">case</span> <span class="s">"exit"</span><span class="o">:</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"안녕!"</span><span class="o">);</span>
            <span class="k">break</span> <span class="n">loop</span><span class="o">;</span>
          <span class="k">default</span><span class="o">:</span>
            <span class="c1">// 커맨드나 필터가 사용할 객체를 준비한다.</span>
            <span class="nc">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Request</span><span class="o">(</span><span class="n">inputStr</span><span class="o">,</span> <span class="n">context</span><span class="o">);</span>

            <span class="c1">// 필터들의 체인을 실행한다.</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">filterChain</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
              <span class="n">filterChain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="nc">Prompt</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

    <span class="c1">// 필터들을 마무리시킨다.</span>
    <span class="n">filterManager</span><span class="o">.</span><span class="na">destroy</span><span class="o">();</span>

    <span class="n">notifyApplicationContextListenerOnServiceStopped</span><span class="o">();</span>
</pre></table></code></div></div><h2 id="mybatis-퍼시스턴스-프레임워크">Mybatis 퍼시스턴스 프레임워크</h2><blockquote><p>bitcamp-java-project-client-41-a</p></blockquote><p>오늘 수업에서는 <em>퍼시스턴스 프레임워크</em> 중 하나인 <strong>mybatis</strong> 프레임워크의 사용법을 배워보았다. 이번 수업의 목표는 <strong>JDBC 코드를 제거</strong>하는 것을 목표로 한다. <strong>Persistance Framework가 JDBC API를 대신 호출</strong>해주기 때문이다. 그러나 JDBC API를 제대로 알지 못하면 안된다.</p><h3 id="persistance-framework">Persistance Framework</h3><p>데이터의 저장, 조회, 변경, 삭제를 다루는 클래스 및 설정 파일들의 집합이다. Persistance Framework를 사용하면 JDBC 프로그래밍의 번거로움 없이 간결하게 데이터베이스와 연동할 수 있다. 소스코드에서 SQL문을 분리하여 관리한다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/50407047/98490619-5d7e2c00-2275-11eb-91bd-28492a2a1741.png" alt="image" /></p><p>프로젝트의 이전 버전에서는 자바 코드에 JDBC API를 호출하는 코드가 있었다. 반면 Persistance Framework는 JDBC API를 호출하는 자바 코드를 <strong>클래스</strong>로 만들어 제공한다. 즉 JDBC 프레임워크를 캡슐화한다. 따라서 자바 코드는 이 Persistance Framework를 호출하면 DBMS에 접근하는 것은 Framework가 가 JDBC API를 사용해서 해준다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/50407047/98491647-e185e300-2278-11eb-9662-7231a9dc4522.png" alt="image" /></p><blockquote><p>프레임워크란? 관련 클래스와 설정 파일</p></blockquote><p>Persistance Framework에는 크게 2가지 종류가 있다. SQL Mapper와 OR(Object Relational) Mapper이다. SQL Mapper는 <strong>테이블</strong>에 대해 질의하지만, OR Mapper는 <strong>객체를 질의</strong>한다는 점에서 차이가 있다.</p><p>SQL Mapper는 각 DBMS에 맞춰서 작성해야 한다. 따라서 DBMS에 종속된다는 단점이 있다. 그러나 그런 만큼 DBMS에 최적화를 시킬 수 있고, 성능을 극한으로 끌어올릴 수 있다는 장점이 있다. 물론 이것은 SQL을 잘 다룬다는 가정 하의 이야기다.</p><p>반면 OR 매퍼는 HSQL과 같이 프레임워크 전용 질의문법을 통해 객체를 질의한다. 즉 DBMS에 상관없이 사용할 수 있는 질의문법으로, DBMS에 종속되지 않는다는 장점이 있다. 그러나 DBMS에 최적화를 시킬 수 없고, DBMS의 성능을 극한으로 끌어올릴 수 없다는 단점이 있다.</p><p>SQL 매퍼와 OR 매퍼가 기존 코드를 어떻게 변경하는지 살펴보자.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/50407047/98531520-ca201780-22c3-11eb-9962-1bb8734b9f2e.png" alt="image" /></p><p>SQL 매퍼는 자바 코드와 SQL 코드로 합쳐져 있는 소스코드를 자바 코드와 SQL문으로 분리하여 관리할 수 있게 해준다. 자바 코드는 SQL Mapper + JDBC API를 호출하고, SQL Mapper는 SQL을 사용한다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/50407047/98538157-afeb3700-22cd-11eb-963f-a2e8739a89fc.png" alt="image" /></p><p>OR Mapper는 전용 질의어를 DBMS에서 인식할 수 있는 SQL로 변환한다. 개발자는 DBMS를 고려할 필요가 없어 프로그래밍이 편하다. 그러나 사용하는 DBMS의 Adapter가 없다면 실행할 수 없다. 즉 DBMS용 Adapter가 있어야 하기 때문에 코드가 특정 OR Mapper에 종속된다는 문제점이 있다.</p><blockquote><p><a href="https://dreaming-soohyun.tistory.com/entry/JPA%EC%99%80-MyBatis%EC%9D%98-%EC%B0%A8%EC%9D%B4-ORM%EA%B3%BC-SQL-Mapper">ORM</a>이란? ORM은 객체 관계 매핑, 객체와 RDB를 별개로 설계하고 ORM이 중간에서 매핑해주는 역할을 한다. 죽 ORM은 SQL문이 아닌 RDB에 데이터 그 자체와 매핑하기 때문에 SQL을 직접 작성할 필요가 없다. 해당 객체와의 매핑에 필요한 SQL문을 만들어준다. 이로인해 어떤 RDB를 사용하던 상관 없다. SQL문이 아닌 ORM에서 제공하는 메서드, 코드 등을 이용하기에 직관적이다.</p></blockquote><blockquote><p>실제로는 Hibernate(OR Mapper)보다 MyBatis(SQL Mapper)를 더 많이 사용한다. 레거시 시스템의 데이터를 다루기 쉽게 하기 때문이다.</p></blockquote><h3 id="mybatis">Mybatis</h3><p>mybatis는 persistance framework 중 하나로, <strong>JDBC 프로그래밍을 캡슐화</strong>하여 <strong>데이터베이스 연동</strong>을 쉽게 하도록 도와준다. 자바 <strong>소스 파일에서 SQL을 분리하여 별도의 파일로 관리</strong>하기 때문에 자바 소스 코드를 <strong>간결하게 유지</strong>할 수 있다.</p><p>JDBC 프로그래밍을 할 때와 마찬가지로 <strong>직접 SQL을 다루기</strong> 때문에 <strong>레거시(legacy) 시스템</strong>에서 사용하는 데이터베이스와 연동할 때 유리하다. SQL을 통해 데이터베이스와 연동한다고 해서 보통 <strong>SQL 매퍼(mapper)</strong>라 부른다.</p><blockquote><p>캡슐화? <strong>클래스로 정의</strong>하는 것을 캡슐화라고 한다. 클래스에서 우리는 무엇을 공개할지, 공개하지 않을 지 접근제어자를 통해서 제어한다. 이렇게 포장해버리고, <strong>우리는 포장된 것을 이용</strong>한다.</p></blockquote><h2 id="실습">실습</h2><h3 id="1단계-프로젝트에-mybatis-라이브러리를-추가한다">1단계: 프로젝트에 MyBatis 라이브러리를 추가한다.</h3><ul><li><code class="language-plaintext highlighter-rouge">mybatis</code> 라이브러리 정보를 찾아 의존 라이브러리 블록에 <code class="language-plaintext highlighter-rouge">mybatis</code> 라이브러리를 등록한다.<li><code class="language-plaintext highlighter-rouge">gradle</code>을 이용해 <code class="language-plaintext highlighter-rouge">eclipse</code> 설정 파일을 갱신한다. -&gt; <code class="language-plaintext highlighter-rouge">$ gradle eclipse</code></ul><h3 id="2단계-mybatis-설정-파일을-준비한다">2단계: <code class="language-plaintext highlighter-rouge">MyBatis</code> 설정 파일을 준비한다.</h3><ul><li><a href="http://www.mybatis.org"><code class="language-plaintext highlighter-rouge">MyBatis</code> 설정 파일에서 참고할 DBMS 접속 정보를 등록한다.</a><li><code class="language-plaintext highlighter-rouge">src/main/resources/com/eomcs/pms/conf/jdbc.properties</code><li>프로그램에서 사용하는 자바 파일은 java에 두고, 설정 파일은 resources에 둔다.<ul><li>나중에 <strong>프로그램에서 사용할 변수와 값</strong>을 작성한다.</ul></ul><div class="language-properties highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># jdbc.properties
# key=value for application
</span><span class="py">jdbc.driver</span><span class="p">=</span><span class="s">org.mariadb.jdbc.Driver</span>
<span class="py">jdbc.url</span><span class="p">=</span><span class="s">jdbc:mysql://localhost:3306/studydb</span>
<span class="py">jdbc.username</span><span class="p">=</span><span class="s">study</span>
<span class="py">jdbc.password</span><span class="p">=</span><span class="s">1111</span>
</pre></table></code></div></div><p>키를 구분하기 쉽기 위해 접두어(<code class="language-plaintext highlighter-rouge">jdbc</code>)를 붙였고, 접두어와 이름을 구분하기 위해 <code class="language-plaintext highlighter-rouge">.</code>을 붙인다. 그러나 접두어+이름 형태가 규칙은 아니다. <code class="language-plaintext highlighter-rouge">접두어.이름</code>은 하나의 키(문자열)일 뿐이다. 단지 구분하기 쉽게 하기 위해 위와 같은 키를 설정했다.</p><ul><li>Mybatis 설정 파일: <code class="language-plaintext highlighter-rouge">src/main/resources/com/eomcs/pms/conf/mybatis-config.xml</code><ul><li>DBMS 서버의 접속 정보를 갖고 있는 <code class="language-plaintext highlighter-rouge">jdbc.properties</code> 파일의 경로를 등록한다.<li>DBMS 서버 정보를 설정한다.<li>DB 커넥션 풀을 설정한다.</ul></ul><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>
<span class="nt">&lt;configuration&gt;</span>

  <span class="c">&lt;!-- 설정 파일에서 사용할 .properties 파일 정보 --&gt;</span>
  <span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">"com/eomcs/pms/conf/jdbc.properties"</span><span class="nt">&gt;&lt;/properties&gt;</span>

  <span class="c">&lt;!-- DBMS 접속 정보들 --&gt;</span>
  <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">"development"</span><span class="nt">&gt;</span>
  
    <span class="c">&lt;!-- 한 개의 DBMS 접속 정보 --&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">"development"</span><span class="nt">&gt;</span>
    
      <span class="c">&lt;!-- mybatis 가 트랜잭션을 다룰 때 사용할 방법을 지정 =&gt; JDBC API 사용 --&gt;</span>
      <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">"JDBC"</span><span class="nt">/&gt;</span>
      
      <span class="c">&lt;!-- 데이터베이스의 연결 정보 =&gt; jdbc.properties 파일에 설정된 key-value --&gt;</span>
      <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">"POOLED"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"driver"</span> <span class="na">value=</span><span class="s">"${jdbc.driver}"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"url"</span> <span class="na">value=</span><span class="s">"${jdbc.url}"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">"${jdbc.username}"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"password"</span> <span class="na">value=</span><span class="s">"${jdbc.password}"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
  <span class="nt">&lt;/environments&gt;</span>
  
  <span class="c">&lt;!-- SQL 문이 들어 있는 파일들 --&gt;</span>
  <span class="nt">&lt;mappers&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">"com/eomcs/pms/mapper/BoardMapper.xml"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></table></code></div></div><p>컴파일되면 자바 클래스 파일과 설정 파일이 합쳐진다. 단, 일반 파일이기 때문에 <code class="language-plaintext highlighter-rouge">.</code>이 아니라 <code class="language-plaintext highlighter-rouge">/</code>를 사용하여 경로를 작성한다.</p><h3 id="3단계-boarddaoimpl에-mybatis를-적용한다">3단계: <code class="language-plaintext highlighter-rouge">BoardDaoImpl</code>에 <code class="language-plaintext highlighter-rouge">Mybatis</code>를 적용한다.</h3><p><code class="language-plaintext highlighter-rouge">com.eomcs.pms.dao.mariadb.BoardImpl</code> 클래스 변경</p><ul><li>SQL을 뜯어내어 <code class="language-plaintext highlighter-rouge">BoardMapper.xml</code>로 옮긴다.<li>JDBC 코드를 뜯어내고 그 자리에 <code class="language-plaintext highlighter-rouge">Mybatis</code> 클래스로 대체한다.</ul><p><strong>변경 전</strong></p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoardDaoImpl</span> <span class="kd">implements</span> <span class="n">com</span><span class="o">.</span><span class="na">eomcs</span><span class="o">.</span><span class="na">pms</span><span class="o">.</span><span class="na">dao</span><span class="o">.</span><span class="na">BoardDao</span><span class="o">{</span>

  <span class="nc">Connection</span> <span class="n">con</span><span class="o">;</span>

  <span class="kd">public</span> <span class="nf">BoardDaoImpl</span><span class="o">(</span><span class="nc">Connection</span> <span class="n">con</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">con</span> <span class="o">=</span> <span class="n">con</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">insert</span><span class="o">(</span><span class="nc">Board</span> <span class="n">board</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">(</span><span class="nc">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span>
        <span class="s">"insert into pms_board(title,content,writer) values(?,?,?)"</span><span class="o">))</span> <span class="o">{</span>

      <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">board</span><span class="o">.</span><span class="na">getTitle</span><span class="o">());</span>
      <span class="n">stmt</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">board</span><span class="o">.</span><span class="na">getContent</span><span class="o">());</span>
      <span class="n">stmt</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">board</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">getNo</span><span class="o">());</span>
      <span class="k">return</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
	<span class="c1">//..</span>
  
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Board</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">(</span><span class="nc">PreparedStatement</span> <span class="n">stmt</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="na">prepareStatement</span><span class="o">(</span>
        <span class="s">"select b.no, b.title, b.cdt, b.vw_cnt, m.no writer_no, m.name"</span>
            <span class="o">+</span> <span class="s">" from pms_board b inner join pms_member m on b.writer=m.no"</span>
            <span class="o">+</span> <span class="s">" order by b.no desc"</span><span class="o">))</span> <span class="o">{</span>

      <span class="k">try</span> <span class="o">(</span><span class="nc">ResultSet</span> <span class="n">rs</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="na">executeQuery</span><span class="o">())</span> <span class="o">{</span>

        <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Board</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

        <span class="k">while</span> <span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
          <span class="nc">Board</span> <span class="n">board</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Board</span><span class="o">();</span>
          <span class="n">board</span><span class="o">.</span><span class="na">setNo</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"no"</span><span class="o">));</span>
          <span class="n">board</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"title"</span><span class="o">));</span>

          <span class="nc">Member</span> <span class="n">member</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">();</span>
          <span class="n">member</span><span class="o">.</span><span class="na">setNo</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"writer_no"</span><span class="o">));</span>
          <span class="n">member</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
          <span class="n">board</span><span class="o">.</span><span class="na">setWriter</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>

          <span class="n">board</span><span class="o">.</span><span class="na">setRegisteredDate</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getDate</span><span class="o">(</span><span class="s">"cdt"</span><span class="o">));</span>
          <span class="n">board</span><span class="o">.</span><span class="na">setViewCount</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getInt</span><span class="o">(</span><span class="s">"vw_cnt"</span><span class="o">));</span>

          <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">board</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>

</pre></table></code></div></div><p><strong>변경 후</strong></p><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BoardDaoImpl</span> <span class="kd">implements</span> <span class="n">com</span><span class="o">.</span><span class="na">eomcs</span><span class="o">.</span><span class="na">pms</span><span class="o">.</span><span class="na">dao</span><span class="o">.</span><span class="na">BoardDao</span><span class="o">{</span>
	<span class="c1">//....</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">insert</span><span class="o">(</span><span class="nc">Board</span> <span class="n">board</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="nc">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">"com/eomcs/pms/conf/mybatis-config.xml"</span><span class="o">);</span>
        <span class="nc">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputstream</span><span class="o">);</span>
    <span class="c1">// mybatis의 커밋 상태</span>
    <span class="c1">// - sqlSession.openSession(): 수동 커밋</span>
    <span class="c1">// - sqlSession.openSession(true): 오토 커밋</span>
    <span class="k">try</span> <span class="o">(</span><span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">(</span><span class="kc">true</span><span class="o">))</span> <span class="o">{</span>
      
      <span class="c1">// =&gt; SqlSession 객체에 insert SQL문을 실행하라고 명령한다.</span>
      <span class="k">return</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="s">"Board.insert"</span><span class="o">,</span> <span class="n">board</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="c1">//....</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Board</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="c1">// mybatis 객체 준비</span>
    
    <span class="c1">// =&gt; mybatis 설정 파일을 읽어 들일 입력 스트림을 준비한다.</span>
    <span class="nc">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="nc">Resources</span><span class="o">.</span><span class="na">getResourceAsstream</span><span class="o">(</span><span class="s">"com/eomcs/pms/conf/mybatis-config.xml"</span><span class="o">);</span>
    
    <span class="c1">// =&gt; 입력 스트림에서 mybatis 설정 값을 읽어 SqlSessionFactory를 만든다.</span>
    <span class="nc">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
    
    <span class="c1">// =&gt; SqlSessionFactory에서 SqlSession 객체를 얻는다.</span>
    <span class="c1">//    SqlSession 객체는 SQL문을 실행하는 객체다.</span>
    <span class="k">try</span> <span class="o">(</span><span class="nc">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">())</span> <span class="o">{</span>
      <span class="c1">// =&gt; SqlSession 객체에게 별도 파일에 분리한 SQL을 찾아 실행하라고 명령한다.</span>
      <span class="k">return</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">selectList</span><span class="o">(</span><span class="s">"BoardDao.findAll"</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>

</pre></table></code></div></div><blockquote><p>SqlSession 객체는 메서드끼리 공유할 수 없다.</p></blockquote><p><strong>BoardMapper.xml</strong></p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span>
  
<span class="c">&lt;!-- namespace 속성: SQL 문을 가리킬 때 사용할 그룹명이다. --&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">"BoardDao"</span><span class="nt">&gt;</span>
  
  <span class="c">&lt;!-- 컬럼의 값을 어떤 자바 객체에 담을 것인지 
       다음과 같이 따로 정의할 수 있다. 
      - type 속성 : 자바 클래스명 
      - id 속성 : 컬럼-프로퍼티의 연결 정보를 가리킬 이름. 
                  SQL 문을 정의할 때 사용.
  --&gt;</span>
  <span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">"com.eomcs.pms.domain.Board"</span> <span class="na">id=</span><span class="s">"BoardMap"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- 자바 코드
         Board b = new Board();
         b.setNo(rs.getInt("no"));
         b.setTitle(rs.getString("title"));
         b.setRegisteredDate(rs.getDate("cdt"));
         b.setViewCount(rs.getInt("vw_cnt"));
    --&gt;</span>
    <span class="nt">&lt;id</span> <span class="na">column=</span><span class="s">"no"</span>     <span class="na">property=</span><span class="s">"no"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"title"</span>  <span class="na">property=</span><span class="s">"title"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"cdt"</span>    <span class="na">property=</span><span class="s">"registeredDate"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"vw_cnt"</span> <span class="na">property=</span><span class="s">"viewCount"</span><span class="nt">/&gt;</span>
    
    <span class="c">&lt;!-- 
      Member m = new Member();
      m.setNo(rs.getInt("no"));
      m.setName(rs.getString("name"));
      b.setWriter(m);
    --&gt;</span>
    <span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">"writer"</span> <span class="na">javaType=</span><span class="s">"com.eomcs.pms.domain.Member"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;id</span> <span class="na">column=</span><span class="s">"writer_no"</span>    <span class="na">property=</span><span class="s">"no"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"name"</span>     <span class="na">property=</span><span class="s">"name"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/association&gt;</span>
  <span class="nt">&lt;/resultMap&gt;</span>


  <span class="c">&lt;!-- select 태그
    - select SQL 문을 정의하는 태그다.
    - id 속성
      - mybatis에서 SQL을 찾을 때 사용할 이름이다.
      - 보통 이 SQL을 사용하는 메서드 이름으로 설정한다.
      - 이렇게 하면 다른 개발자가 이해하기 쉬울 것이다.
    - resultType 속성
      - select 결과물에서 각 레코드 값을 담을 도메인 객체 이름이다.
      - select의 결과가 여러 개라면, 해당 도메인 객체도 여러 개가 생성될 것이다.
      - 이렇게 여러 개 생성된 도메인 객체는 List 컬렉션 객체에 저장된다.
      - 그리고 List 컬렉션 객체가 최종적으로 리턴된다.
   --&gt;</span>
  <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"findAll"</span> <span class="na">resultMap=</span><span class="s">"BoardMap"</span><span class="nt">&gt;</span>
    select 
      b.no, 
      b.title, 
      b.cdt, 
      b.vw_cnt, 
      m.no writer_no, 
      m.name
    from 
      pms_board b 
      inner join pms_member m on b.writer=m.no
    order by 
      b.no desc
  <span class="nt">&lt;/select&gt;</span>
  
  <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insert"</span> <span class="na">parameterType=</span><span class="s">"com.eomcs.pms.domain.Board"</span><span class="nt">&gt;</span>
    insert into pms_board(title,content,writer) 
    values(#{title}, #{content}, #{writer.no})
  <span class="nt">&lt;/insert&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</pre></table></code></div></div><ul><li><p><code class="language-plaintext highlighter-rouge">namespace</code> 속성</p><ul><li><code class="language-plaintext highlighter-rouge">&lt;mapper namespace="BoardDao"&gt;</code><li>SQL 문을 가리킬 때 사용할 그룹명이다.<li>보통 SQL을 사용하는 객체 이름으로 설정한다.<li>즉 DAO 인터페이스 또는 클래스명으로 설정한다.<li>그래야만 유지보수할 때 DAO와 연결된 SQL을 바로 찾을 수 있다.</ul><li><p>컬럼의 값을 어떤 자바 객체에 담을 것인지 다음과 같이 따로 정의할 수 있다.</p><ul><li><code class="language-plaintext highlighter-rouge">&lt;resultMap type="com.eomcs.pms.domain.Board id="BoardMap"&gt;</code><ul><li><code class="language-plaintext highlighter-rouge">type</code> 속성: 자바 클래스 명<li><code class="language-plaintext highlighter-rouge">id</code> 속성: 컬럼-프로퍼티의 연결 정보를 가리킬 이름 SQL문을 정의할 때 사용</ul><li><code class="language-plaintext highlighter-rouge">&lt;association/&gt;</code>: Member라는 클래스의 객체를 만들어서 setNo를 호출해서 값을 담고, setName을 호출해서 값을 담하라. 그리고 Member 클래스를 setWriter를 호출해서 값을 담아라.</ul><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">"com.eomcs.pms.domain.Board"</span> <span class="na">id=</span><span class="s">"BoardMap"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;id</span> <span class="na">column=</span><span class="s">"no"</span> <span class="na">property=</span><span class="s">"no"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"title"</span> <span class="na">property=</span><span class="s">"title"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"cdt"</span> <span class="na">property=</span><span class="s">"registeredDate"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"vw_cnt"</span> <span class="na">property=</span><span class="s">"viewCount"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">"writer"</span> <span class="na">javaType=</span><span class="s">"com.eomcs.pms.domain.Member"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;id</span> <span class="na">column=</span><span class="s">"writer_no"</span> <span class="na">property=</span><span class="s">"no"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"name"</span> <span class="na">property=</span><span class="s">"name"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/association&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
</pre></table></code></div></div><li><p><code class="language-plaintext highlighter-rouge">&lt;select&gt;</code> SQL문을 정의하는 태그이다.</p><li><p><code class="language-plaintext highlighter-rouge">id</code> 속성</p><ul><li>mybatis에서 SQL을 찾을 때 사용할 이다.<li>보통 이 SQL을 사용하는 메서드 이름으로 설정한다.<li>이렇게 하면 다른 개발자가 이해하기 쉬울 것이다.</ul><li><p><code class="language-plaintext highlighter-rouge">resultType</code> 속성</p><ul><li><code class="language-plaintext highlighter-rouge">select</code> 결과물에서 각 도메인이다.<li><code class="language-plaintext highlighter-rouge">select</code>의 결과가 여러 개라면, 하나의 도메인 객체도 여러 개가 생성될 것이다.<li>이렇게 여러 개 생성된 도메인 객체는 <code class="language-plaintext highlighter-rouge">List</code> 컬렉션 객체에 저장될 것이다.<li>그리고 <code class="language-plaintext highlighter-rouge">List</code> 컬렉션 객체가 최종적으로 리턴된다.</ul><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"findAll"</span> <span class="na">resultMap=</span><span class="s">"BoardMap"</span><span class="nt">&gt;</span>
  select 
  	b.no, 
  	b.title, 
  	b.cdt, 
  	b.vw_cnt, 
  	m.no writer_no, 
  	m.name 
  from 
  	pms_board b 
  	inner join pms_member m on b.writer=m.no 
  order by 
  	b.no desc
<span class="nt">&lt;/select&gt;</span>
</pre></table></code></div></div></ul><h3 id="mybatis-select-실행-과정">mybatis select 실행 과정</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/50407047/98543909-85ea4280-22d6-11eb-9ceb-24ac493e2ea2.png" alt="image" /></p><h3 id="select-결과를-자바-객체에-저장하기">select 결과를 자바 객체에 저장하기</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/50407047/98545272-956a8b00-22d8-11eb-90c9-cd93fd50ab89.png" alt="image" /></p><ul><li>컬럼 이름과 같은 자바 필드에 값을 저장한다.<li>필드는 프로퍼티가 아니다.<li><code class="language-plaintext highlighter-rouge">get프로퍼티명()</code>, <code class="language-plaintext highlighter-rouge">set프로퍼티명()</code>가 둘다 있다면 read/writer 프로퍼티, <code class="language-plaintext highlighter-rouge">get프로퍼티()</code>만 있다면 read only 프로퍼티이다.</ul><p>mybatis는 select 결과를 자바 객체에 저장할 때 우선 프로퍼티를 찾는다. mybatis는 컬럼명이랑 일치하는 프로퍼티(setter)를 찾아서 저장한다. 이때 setter가 없다면 필드를 찾는다. 보통 특별한 경우가 아니면 프로퍼티 이름은 필드명과 같다. 그러나 이것은 setter에서 set을 빼고 뒤의 글자를 소문자화해서 같아진 것이지, 프로퍼티와 필드는 같은 뜻이 아니다.</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">"BoardDao"</span><span class="nt">&gt;</span>

<span class="c">&lt;!-- 컬럼의 값을 어떤 자바 객체에 담을 것인지
다음과 같이 따로 정의할 수 있다. 
 - type 속성: 컬럼-프로퍼티 연결 
 - id 속성: 컬럼-프로퍼티의 연결 정보를 가리킬 이름. 
 						SQL문을 정의할 때 사용
 --&gt;</span>

<span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">"com.eomcs.pms.domain.Board"</span> <span class="na">id=</span><span class="s">"BoardMap"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"no"</span> 		<span class="na">property=</span><span class="s">"no"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"title"</span> 	<span class="na">property=</span><span class="s">"title"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"cdt"</span> 		<span class="na">property=</span><span class="s">"registeredDate"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"vw_cnt"</span> <span class="na">property=</span><span class="s">"viewCount"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>

<span class="c">&lt;!-- select 태그
	-  --&gt;</span>
	<span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"findAll"</span> <span class="na">resultMap=</span><span class="s">"BoardMap"</span><span class="nt">&gt;</span>
	select 
	b.no, 
	b.title, 
	b.cdt, 
	b.vw_cdt, 
	m.no writer_no, 
	m.name
	from pms_board b inner join pms_member m on b.writer=m.no
	order by b.no desc
	<span class="nt">&lt;/select&gt;</span>

	<span class="c">&lt;!-- select 태그 --&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">resultMap</code> 속성의 값을 <code class="language-plaintext highlighter-rouge">BoardMap</code>으로 하게 되면 이제 select 문 안에서 별명을 지정하지 않아도 된다.</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">"com.eomcs.pms.domain.Board"</span> <span class="na">id=</span><span class="s">"BoardMap"</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- primary 값: id태그 지정--&gt;</span>
	<span class="nt">&lt;id</span> <span class="na">column=</span><span class="s">"no"</span> 		<span class="na">property=</span><span class="s">"no"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"title"</span> 	<span class="na">property=</span><span class="s">"title"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"cdt"</span> 		<span class="na">property=</span><span class="s">"registeredDate"</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">"vw_cnt"</span> <span class="na">property=</span><span class="s">"viewCount"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/resultMap&gt;</span>
</pre></table></code></div></div><p>Primary Key에 대해 id 태그를 지정해주면 같은 select를 했을 때 기존에 보관되었던 select 결과를 리턴한다.</p><blockquote><p>=&gt; 내일 질문: select 결과는 어디에 어떤 형식으로 저장되는가?</p></blockquote><h3 id="ognl-object-graph-navigration-language">OGNL: Object Graph Navigration Language</h3><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">Board</span> <span class="o">{</span>
  <span class="nc">Member</span> <span class="n">writer</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Member</span> <span class="o">{</span>
  <span class="kt">int</span> <span class="n">no</span><span class="o">;</span>
  <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
  <span class="nc">Address</span> <span class="n">addr</span><span class="o">;</span>
  
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Address</span> <span class="o">{</span>
  <span class="nc">String</span> <span class="n">postNo</span><span class="o">;</span>
  <span class="nc">String</span> <span class="n">baseAddr</span><span class="o">;</span>
<span class="o">}</span>


<span class="nc">Address</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Address</span><span class="o">();</span>
<span class="nc">Member</span> <span class="n">m</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Member</span><span class="o">();</span>
<span class="n">m</span><span class="o">.</span><span class="na">setAddr</span><span class="o">(</span><span class="n">a</span><span class="o">);</span>
<span class="nc">Board</span> <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Board</span><span class="o">();</span>
<span class="n">b</span><span class="o">.</span><span class="na">setWriter</span><span class="o">(</span><span class="n">m</span><span class="o">);</span>
</pre></table></code></div></div><p>주소 알아내기 =&gt; <code class="language-plaintext highlighter-rouge">b.getWriter().getAddr().getBaseAddr()</code> 이걸 OGNL 표기법으로 표시하면 <code class="language-plaintext highlighter-rouge">b.writer.addr.baseAddr</code> 이렇게 된다. mybatis는 OGNL 표기법을 사용한다.</p><div class="language-xml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">"insert"</span> <span class="na">parameterType=</span><span class="s">"com.eomcs.pms.domain.board"</span><span class="nt">&gt;</span>
  insert into pms_board(title,content,writer) 
  values(#{title}, #{content}, #{writer.no})")
<span class="nt">&lt;/insert&gt;</span>

</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/bitcamp/'>bitcamp</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/bitcamp/" class="post-tag no-text-decoration" >bitcamp</a> <a href="/tags/java/" class="post-tag no-text-decoration" >java</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=학원 #75일차: Chain of Responsibility 패턴, Persistance 프레임워크 MyBatis - 하연&url=https://hayeon17kim.github.io//posts/201109-75/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=학원 #75일차: Chain of Responsibility 패턴, Persistance 프레임워크 MyBatis - 하연&u=https://hayeon17kim.github.io//posts/201109-75/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=학원 #75일차: Chain of Responsibility 패턴, Persistance 프레임워크 MyBatis - 하연&url=https://hayeon17kim.github.io//posts/201109-75/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/system-deisign-capacity-estimation/">System Design: Capacity Estimate</a><li><a href="/posts/today-i-learned-2021-04-27/">주니어 성장일기: 2021.04.27</a><li><a href="/posts/today-i-learned-2021-04-26/">주니어 성장일기: 2021.04.26</a><li><a href="/posts/fastcampus-01/">자료구조와 알고리즘이란</a><li><a href="/posts/today-i-learned-2021-04-25/">주니어 성장일기: 2021.04.25</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/javascript/">JavaScript</a> <a class="post-tag" href="/tags/bitcamp/">bitcamp</a> <a class="post-tag" href="/tags/modernjs/">modernJS</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/trouble-shooting/">trouble-shooting</a> <a class="post-tag" href="/tags/devil/">devil</a> <a class="post-tag" href="/tags/corejs/">corejs</a> <a class="post-tag" href="/tags/network/">network</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/201123-85/"><div class="card-body"> <span class="timeago small" > Nov 23, 2020 <i class="unloaded">2020-11-23T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>학원 #85일차:서블릿 프로그래밍, WAS, JavaEE와 Servlet 컨테이너, Servlet 인터페이스의 Life-cycle 메서드</h3><div class="text-muted small"><p> 서블릿 프로그래밍 웹 애플리케이션 서버 아키텍쳐의 개념 JavaEE와 Servlet API의 관계 JavaEE 구현체와 서블릿 컨테이너의 관계 eomcs-web-project/src-00 예제 실습 Servlet 인터페이스와 Life-cycle 메서드 WAS(Web Application Server) 아키텍처 이전까지는 사...</p></div></div></a></div><div class="card"> <a href="/posts/201124-86/"><div class="card-body"> <span class="timeago small" > Nov 24, 2020 <i class="unloaded">2020-11-24T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>학원 #86일차:서블릿 프로그래밍, 프로젝트를 WAS 아키텍처로 전환</h3><div class="text-muted small"><p> 서블릿 컨테이너가 관리하는 컴포넌트는 서블릿, 필터, 리스너로 3가지이다. Servlet 만들기 1. javax.servlet.Servlet 인터페이스 구현 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38...</p></div></div></a></div><div class="card"> <a href="/posts/201125-87/"><div class="card-body"> <span class="timeago small" > Nov 25, 2020 <i class="unloaded">2020-11-25T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>학원 #87일차: HTML 태그 사용법</h3><div class="text-muted small"><p> HTML/CSS 학습법: 결과 화면 먼저 보고 소스코드를 확인하자 UI와 UX UX(User Experience; 사용자 경험): 사용자 편의성 ex: 링크에 hover했을 때 커서가 손모양으로 바뀌어야 한다. UI(User Interface): 기능을 하는 화면이 있는가 HTML ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/network-for-everyone-04/" class="btn btn-outline-primary" prompt="Older"><p>모두의 네트워크 #4장: 데이터 링크 계층</p></a> <a href="/posts/201110-76/" class="btn btn-outline-primary" prompt="Newer"><p>학원 #76일차: 프로젝트에 MyBatis 적용: MyBatis가 join 결과를 다루는 방법, 프로그램에서 사용하는 객체를 listener에서 준비시키기, sqlSessionFactory 공유,</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Loading comments from <a href="https://disqus.com/">Disqus</a> ...</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//hayeon17kim-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = '학원 #75일차: Chain of Responsibility 패턴, Persistance 프레임워크 MyBatis'; this.page.url = 'https://hayeon17kim.github.io//posts/201109-75/'; this.page.identifier = '/posts/201109-75/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/MONI56219559">hayeon_kim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/javascript/">JavaScript</a> <a class="post-tag" href="/tags/bitcamp/">bitcamp</a> <a class="post-tag" href="/tags/modernjs/">modernJS</a> <a class="post-tag" href="/tags/project/">project</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/trouble-shooting/">trouble shooting</a> <a class="post-tag" href="/tags/devil/">devil</a> <a class="post-tag" href="/tags/corejs/">corejs</a> <a class="post-tag" href="/tags/network/">network</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://hayeon17kim.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
